# Contact Management System
# Week 3 Project - Functions & Dictionaries

import json
import re
from datetime import datetime

DATA_FILE = "contacts_data.json"


def load_contacts():
    """Load contacts from JSON file"""
    try:
        with open(DATA_FILE, "r") as file:
            return json.load(file)
    except (FileNotFoundError, json.JSONDecodeError):
        return {}


def save_contacts(contacts):
    """Save contacts to JSON file"""
    with open(DATA_FILE, "w") as file:
        json.dump(contacts, file, indent=4)


def validate_phone(phone):
    """Validate phone number format"""
    digits = re.sub(r'\D', '', phone)
    if 10 <= len(digits) <= 15:
        return True, digits
    return False, None


def validate_email(email):
    """Validate email format"""
    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    return re.match(pattern, email) is not None


def add_contact(contacts):
    """Add a new contact"""
    print("\n--- ADD NEW CONTACT ---")

    while True:
        name = input("Enter contact name: ").strip()
        if name:
            if name in contacts:
                print("Contact already exists.")
                return update_contact(contacts, name)
            break
        print("Name cannot be empty!")

    while True:
        phone = input("Enter phone number: ").strip()
        val
